<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vue2 + Element UI 拖拽式选项卡容器</title>
  <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
  <script src="https://unpkg.com/element-ui/lib/index.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
  <script src="https://cdn.bootcdn.net/ajax/libs/Vue.Draggable/2.24.3/vuedraggable.umd.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Helvetica Neue', Arial, sans-serif;
    }
    
    body {
      background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
      min-height: 100vh;
      padding: 20px;
      color: #333;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    
    .header {
      text-align: center;
      margin-bottom: 30px;
      color: white;
      text-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }
    
    .header h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
    }
    
    .header p {
      font-size: 1.2rem;
      opacity: 0.9;
    }
    
    .app-container {
      display: flex;
      gap: 20px;
      margin-bottom: 30px;
    }
    
    @media (max-width: 768px) {
      .app-container {
        flex-direction: column;
      }
    }
    
    .components-panel {
      flex: 1;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 8px 16px rgba(0,0,0,0.2);
      transition: all 0.3s ease;
    }
    
    .components-panel:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 24px rgba(0,0,0,0.25);
    }
    
    .components-panel h2 {
      color: #1a2a6c;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 2px solid #e4e7ed;
    }
    
    .draggable-component {
      background: white;
      border: 1px dashed #1a2a6c;
      border-radius: 6px;
      padding: 12px;
      margin: 10px 0;
      cursor: move;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    
    .draggable-component:hover {
      background: #f0f7ff;
      border-style: solid;
      transform: translateX(5px);
    }
    
    .drag-icon {
      margin-right: 10px;
      color: #1a2a6c;
      font-size: 18px;
    }
    
    .tabs-container {
      flex: 2;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 8px 16px rgba(0,0,0,0.2);
      min-height: 500px;
      transition: all 0.3s ease;
    }
    
    .tabs-container:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 24px rgba(0,0,0,0.25);
    }
    
    .tabs-container h2 {
      color: #1a2a6c;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 2px solid #e4e7ed;
    }
    
    .tab-content {
      padding: 20px;
      background: white;
      border-radius: 0 0 8px 8px;
      min-height: 400px;
      border: 1px solid #ebeef5;
      border-top: none;
    }
    
    .draggable-item {
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      border-radius: 4px;
      padding: 15px;
      margin: 10px 0;
      display: flex;
      align-items: center;
      transition: all 0.3s;
    }
    
    .draggable-item:hover {
      background: #e9f7fe;
      border-color: #1a2a6c;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.05);
    }
    
    .draggable-item .delete-btn {
      margin-left: auto;
      color: #f56c6c;
      cursor: pointer;
      opacity: 0.7;
      transition: all 0.2s;
    }
    
    .draggable-item .delete-btn:hover {
      opacity: 1;
      transform: scale(1.2);
    }
    
    .instructions {
      background: rgba(255, 255, 255, 0.9);
      border-radius: 10px;
      padding: 20px;
      margin-top: 20px;
      box-shadow: 0 8px 16px rgba(0,0,0,0.2);
    }
    
    .instructions h2 {
      color: #1a2a6c;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 2px solid #e4e7ed;
    }
    
    .steps {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 15px;
    }
    
    .step {
      background: white;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.05);
      border-left: 4px solid #1a2a6c;
    }
    
    .step h3 {
      color: #1a2a6c;
      margin-bottom: 8px;
    }
    
    .ghost {
      opacity: 0.5;
      background: #cce5ff;
      border: 2px dashed #1a2a6c;
    }
    
    .drag-handle {
      cursor: move;
    }
    
    .empty-tab {
      text-align: center;
      padding: 40px;
      color: #909399;
    }
    
    .empty-tab i {
      font-size: 48px;
      margin-bottom: 15px;
      display: block;
      color: #c0c4cc;
    }
    
    .footer {
      text-align: center;
      margin-top: 30px;
      color: white;
      padding: 15px;
      opacity: 0.8;
    }
  </style>
</head>
<body>
  <div id="app">
    <div class="container">
      <div class="header">
        <h1>Vue2 + Element UI 拖拽式选项卡容器</h1>
        <p>将输入框组件拖拽到选项卡中，自由构建您的界面</p>
      </div>
      
      <div class="app-container">
        <div class="components-panel">
          <h2>可拖拽组件</h2>
          <draggable 
            :list="components" 
            :group="{ name: 'components', pull: 'clone', put: false }"
            :sort="false"
            @start="dragStart"
            @end="dragEnd"
          >
            <div v-for="(comp, index) in components" :key="index" class="draggable-component">
              <i class="el-icon-rank drag-handle drag-icon"></i>
              <div>
                <h3>{{ comp.title }}</h3>
                <p>{{ comp.description }}</p>
              </div>
            </div>
          </draggable>
        </div>
        
        <div class="tabs-container">
          <h2>选项卡容器</h2>
          <el-tabs v-model="activeTab" type="card" @tab-remove="removeTab">
            <el-tab-pane
              v-for="(tab, index) in tabs"
              :key="index"
              :label="tab.name"
              :name="tab.name"
              :closable="tab.closable"
            >
              <draggable
                :list="tab.items"
                group="components"
                ghost-class="ghost"
                :animation="200"
                @add="onAdd($event, tab)"
              >
                <transition-group name="list" tag="div" class="tab-content">
                  <div v-for="(item, itemIndex) in tab.items" :key="item.id" class="draggable-item">
                    <i class="el-icon-rank drag-handle drag-icon"></i>
                    <div class="item-content">
                      <h3>{{ item.title }}</h3>
                      <el-input
                        v-if="item.type === 'text'"
                        v-model="item.value"
                        :placeholder="item.placeholder"
                      ></el-input>
                      <el-input
                        v-if="item.type === 'password'"
                        v-model="item.value"
                        :placeholder="item.placeholder"
                        show-password
                      ></el-input>
                      <el-input
                        v-if="item.type === 'textarea'"
                        v-model="item.value"
                        type="textarea"
                        :rows="2"
                        :placeholder="item.placeholder"
                      ></el-input>
                    </div>
                    <i class="el-icon-delete delete-btn" @click="removeItem(tab, itemIndex)"></i>
                  </div>
                  
                  <div v-if="tab.items.length === 0" class="empty-tab">
                    <i class="el-icon-upload"></i>
                    <h3>拖拽组件到此处</h3>
                    <p>从左侧面板拖拽输入框组件到该区域</p>
                  </div>
                </transition-group>
              </draggable>
            </el-tab-pane>
          </el-tabs>
          
          <el-button 
            type="primary" 
            icon="el-icon-plus" 
            @click="addTab"
            style="margin-top: 15px;"
          >
            添加新选项卡
          </el-button>
        </div>
      </div>
      
      <div class="instructions">
        <h2>使用说明</h2>
        <div class="steps">
          <div class="step">
            <h3><i class="el-icon-caret-right"></i> 添加组件</h3>
            <p>从左侧面板拖拽任意输入框组件到选项卡中</p>
          </div>
          <div class="step">
            <h3><i class="el-icon-caret-right"></i> 管理选项卡</h3>
            <p>点击"添加新选项卡"按钮创建新选项卡，点击标签上的×关闭选项卡</p>
          </div>
          <div class="step">
            <h3><i class="el-icon-caret-right"></i> 重新排序</h3>
            <p>在选项卡内拖动组件可以改变它们的顺序</p>
          </div>
          <div class="step">
            <h3><i class="el-icon-caret-right"></i> 删除组件</h3>
            <p>点击组件右上角的删除图标移除组件</p>
          </div>
        </div>
      </div>
      
      <div class="footer">
        <p>Vue2 + Element UI + vuedraggable 实现 | 拖拽式选项卡容器</p>
      </div>
    </div>
  </div>

  <script>
    Vue.component('draggable', vuedraggable);
    
    new Vue({
      el: '#app',
      data() {
        return {
          activeTab: '选项卡1',
          components: [
            {
              id: 1,
              type: 'text',
              title: '文本输入框',
              description: '标准文本输入字段',
              placeholder: '请输入文本内容',
              value: ''
            },
            {
              id: 2,
              type: 'password',
              title: '密码输入框',
              description: '安全密码输入字段',
              placeholder: '请输入密码',
              value: ''
            },
            {
              id: 3,
              type: 'textarea',
              title: '多行文本框',
              description: '支持多行文本输入',
              placeholder: '请输入多行文本',
              value: ''
            }
          ],
          tabs: [
            {
              name: '选项卡1',
              closable: false,
              items: []
            },
            {
              name: '选项卡2',
              closable: true,
              items: []
            }
          ],
          nextTabIndex: 3
        }
      },
      methods: {
        addTab() {
          const newTabName = `选项卡${this.nextTabIndex++}`;
          this.tabs.push({
            name: newTabName,
            closable: true,
            items: []
          });
          this.activeTab = newTabName;
        },
        removeTab(targetName) {
          const tabs = this.tabs;
          let activeName = this.activeTab;
          
          if (activeName === targetName) {
            tabs.forEach((tab, index) => {
              if (tab.name === targetName) {
                const nextTab = tabs[index + 1] || tabs[index - 1];
                if (nextTab) {
                  activeName = nextTab.name;
                }
              }
            });
          }
          
          this.activeTab = activeName;
          this.tabs = tabs.filter(tab => tab.name !== targetName);
        },
        onAdd(evt, tab) {
          // 克隆对象以避免引用问题
          debugger
          const newItem = JSON.parse(JSON.stringify(evt.item.__draggable_component__.$attrs['data-item']));
          newItem.id = Date.now(); // 生成唯一ID
          tab.items.push(newItem);
        },
        removeItem(tab, index) {
          tab.items.splice(index, 1);
        },
        dragStart(evt) {
          evt.item.style.opacity = '0.4';
        },
        dragEnd(evt) {
          evt.item.style.opacity = '1';
        }
      }
    });
  </script>
</body>
</html>